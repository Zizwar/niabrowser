<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NIABrowser - Feature Test Page</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0A0A0F; color: #F0F0F5; line-height: 1.5; padding: 16px; padding-top: 60px; }
    a { color: #007AFF; }
    header { position: fixed; top: 0; left: 0; right: 0; z-index: 100; background: rgba(10,10,15,0.95); backdrop-filter: blur(10px); padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #2A2A3A; }
    header h1 { font-size: 16px; font-weight: 700; }
    header h1 span { color: #007AFF; }
    header a { font-size: 13px; }
    .card { background: #161620; border: 1px solid #2A2A3A; border-radius: 12px; padding: 16px; margin-bottom: 16px; }
    .card h2 { font-size: 16px; font-weight: 600; margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
    .card h2 .icon { font-size: 18px; }
    .btn { display: inline-block; padding: 8px 14px; border-radius: 8px; font-size: 13px; font-weight: 500; cursor: pointer; border: none; margin: 3px; }
    .btn-blue { background: #007AFF; color: #fff; }
    .btn-green { background: #34C759; color: #fff; }
    .btn-orange { background: #FF9500; color: #fff; }
    .btn-red { background: #FF3B30; color: #fff; }
    .btn-gray { background: #2C2C3E; color: #F0F0F5; }
    .output { background: #0D0D14; border: 1px solid #2A2A3A; border-radius: 8px; padding: 10px; margin-top: 10px; font-family: monospace; font-size: 12px; color: #8E8EA0; max-height: 200px; overflow-y: auto; white-space: pre-wrap; word-break: break-all; }
    .output .success { color: #34C759; }
    .output .error { color: #FF3B30; }
    .output .warn { color: #FF9500; }
    .output .info { color: #007AFF; }
    .btn-row { display: flex; flex-wrap: wrap; gap: 4px; margin-bottom: 8px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 13px; }
    th, td { padding: 8px 10px; border: 1px solid #2A2A3A; text-align: left; }
    th { background: #1A1A28; font-weight: 600; }
    input[type="text"], input[type="number"] { background: #1A1A28; border: 1px solid #2A2A3A; border-radius: 6px; padding: 8px 10px; color: #F0F0F5; font-size: 13px; width: 100%; margin: 4px 0; }
    .counter { font-size: 48px; font-weight: 700; text-align: center; padding: 20px; color: #007AFF; }
    .color-box { width: 100%; height: 60px; border-radius: 8px; margin-top: 8px; transition: background 0.3s; display: flex; align-items: center; justify-content: center; font-weight: 600; }
    .hidden-content { display: none; background: #1A1A28; padding: 12px; border-radius: 8px; margin-top: 8px; }
    .hidden-content.visible { display: block; }
    .metric { display: inline-block; background: #1A1A28; padding: 8px 14px; border-radius: 8px; margin: 4px; font-size: 12px; }
    .metric .val { font-size: 18px; font-weight: 700; color: #007AFF; display: block; }
  </style>
</head>
<body>
  <header>
    <h1>NIA<span>Browser</span> Test Page</h1>
    <a href="../index.html">Back to Home</a>
  </header>

  <!-- Network Testing -->
  <div class="card">
    <h2><span class="icon">&#x1F310;</span> Network Testing</h2>
    <p style="font-size:13px;color:#8E8EA0;margin-bottom:8px;">Test API calls — visible in NIABrowser's Network monitor</p>
    <div class="btn-row">
      <button class="btn btn-blue" onclick="testFetch('GET')">GET</button>
      <button class="btn btn-green" onclick="testFetch('POST')">POST</button>
      <button class="btn btn-orange" onclick="testFetch('PUT')">PUT</button>
      <button class="btn btn-red" onclick="testFetch('DELETE')">DELETE</button>
      <button class="btn btn-gray" onclick="testMultiple()">5x Parallel</button>
    </div>
    <div id="network-output" class="output">Ready...</div>
  </div>

  <!-- Console Testing -->
  <div class="card">
    <h2><span class="icon">&#x1F4CB;</span> Console Testing</h2>
    <p style="font-size:13px;color:#8E8EA0;margin-bottom:8px;">Generate console messages — visible in NIABrowser's Console panel</p>
    <div class="btn-row">
      <button class="btn btn-blue" onclick="console.log('Test log message:', new Date().toISOString())">console.log</button>
      <button class="btn btn-orange" onclick="console.warn('Test warning:', {code: 'W001', detail: 'Something may be wrong'})">console.warn</button>
      <button class="btn btn-red" onclick="console.error('Test error:', new Error('Something went wrong'))">console.error</button>
      <button class="btn btn-gray" onclick="console.info('Test info: App version 1.1.0')">console.info</button>
      <button class="btn btn-red" onclick="triggerError()">Uncaught Error</button>
    </div>
    <div class="btn-row">
      <button class="btn btn-gray" onclick="console.log({user:'test',roles:['admin','editor'],meta:{created:'2025-01-01'}})">Log Object</button>
      <button class="btn btn-gray" onclick="console.log([1,2,3,'hello',{nested:true}])">Log Array</button>
      <button class="btn btn-gray" onclick="console.table([{name:'Alice',age:30},{name:'Bob',age:25}])">console.table</button>
    </div>
  </div>

  <!-- Storage Testing -->
  <div class="card">
    <h2><span class="icon">&#x1F4BE;</span> Storage Testing</h2>
    <p style="font-size:13px;color:#8E8EA0;margin-bottom:8px;">Manage localStorage, sessionStorage, cookies — visible in NIABrowser's Storage panel</p>
    <div class="btn-row">
      <button class="btn btn-green" onclick="setStorage()">Set localStorage</button>
      <button class="btn btn-blue" onclick="getStorage()">Read All</button>
      <button class="btn btn-red" onclick="localStorage.clear();appendOutput('storage-output','Cleared localStorage','success')">Clear localStorage</button>
    </div>
    <div class="btn-row">
      <button class="btn btn-green" onclick="setCookie()">Set Cookie</button>
      <button class="btn btn-blue" onclick="readCookies()">Read Cookies</button>
      <button class="btn btn-red" onclick="clearCookies()">Clear Cookies</button>
    </div>
    <div id="storage-output" class="output">Ready...</div>
  </div>

  <!-- DOM Manipulation -->
  <div class="card">
    <h2><span class="icon">&#x1F3A8;</span> DOM Manipulation Targets</h2>
    <p style="font-size:13px;color:#8E8EA0;margin-bottom:8px;">Elements for testing scripts — try NIA AI: "change the counter color" or "hide the color box"</p>
    <div id="counter-display" class="counter">0</div>
    <div class="btn-row" style="justify-content:center;">
      <button class="btn btn-blue" onclick="changeCounter(1)">+1</button>
      <button class="btn btn-red" onclick="changeCounter(-1)">-1</button>
      <button class="btn btn-gray" onclick="document.getElementById('counter-display').textContent='0'">Reset</button>
    </div>
    <div id="color-box" class="color-box" style="background:#007AFF;">Click buttons to change color</div>
    <div class="btn-row" style="margin-top:8px;">
      <button class="btn btn-blue" onclick="setColor('#007AFF')">Blue</button>
      <button class="btn btn-green" onclick="setColor('#34C759')">Green</button>
      <button class="btn btn-orange" onclick="setColor('#FF9500')">Orange</button>
      <button class="btn btn-red" onclick="setColor('#FF3B30')">Red</button>
      <button class="btn btn-gray" onclick="setColor('#'+Math.floor(Math.random()*16777215).toString(16).padStart(6,'0'))">Random</button>
    </div>
    <div id="toggle-content" class="hidden-content">
      <p>This content was hidden! Scripts can show/hide elements on the page.</p>
      <p>Secret data: API_KEY=demo_12345_test</p>
    </div>
    <button class="btn btn-gray" onclick="document.getElementById('toggle-content').classList.toggle('visible')" style="margin-top:8px;">Toggle Hidden Content</button>
  </div>

  <!-- Script Targets -->
  <div class="card">
    <h2><span class="icon">&#x1F4CA;</span> Script Injection Targets</h2>
    <p style="font-size:13px;color:#8E8EA0;margin-bottom:8px;">Data tables and lists for scripts to modify — try AI: "highlight rows where price > 50"</p>
    <table id="data-table">
      <thead><tr><th>Product</th><th>Category</th><th>Price</th><th>Stock</th></tr></thead>
      <tbody>
        <tr><td>Laptop Pro</td><td>Electronics</td><td>$999</td><td>15</td></tr>
        <tr><td>Wireless Mouse</td><td>Accessories</td><td>$29</td><td>200</td></tr>
        <tr><td>USB-C Hub</td><td>Accessories</td><td>$59</td><td>85</td></tr>
        <tr><td>Monitor 27"</td><td>Electronics</td><td>$449</td><td>32</td></tr>
        <tr><td>Keyboard</td><td>Accessories</td><td>$79</td><td>120</td></tr>
        <tr><td>Webcam HD</td><td>Electronics</td><td>$89</td><td>0</td></tr>
        <tr><td>Cable Pack</td><td>Accessories</td><td>$15</td><td>500</td></tr>
      </tbody>
    </table>

    <h3 style="margin-top:16px;font-size:14px;">Link List</h3>
    <ul id="link-list" style="padding-left:20px;margin-top:8px;font-size:13px;">
      <li><a href="https://github.com">GitHub</a> - Code hosting</li>
      <li><a href="https://stackoverflow.com">Stack Overflow</a> - Q&A</li>
      <li><a href="https://developer.mozilla.org">MDN</a> - Web docs</li>
      <li><a href="https://npmjs.com">NPM</a> - Package registry</li>
      <li><a href="https://caniuse.com">Can I Use</a> - Browser support</li>
    </ul>

    <h3 style="margin-top:16px;font-size:14px;">Form</h3>
    <form id="test-form" onsubmit="event.preventDefault();appendOutput('form-output','Form submitted: '+new FormData(this).get('name'),'success')">
      <input type="text" name="name" placeholder="Enter your name..." />
      <input type="text" name="email" placeholder="Enter email..." />
      <button class="btn btn-green" type="submit" style="margin-top:4px;">Submit Form</button>
    </form>
    <div id="form-output" class="output" style="margin-top:8px;">Waiting for form submit...</div>
  </div>

  <!-- Performance Testing -->
  <div class="card">
    <h2><span class="icon">&#x26A1;</span> Performance Testing</h2>
    <p style="font-size:13px;color:#8E8EA0;margin-bottom:8px;">Trigger heavy operations — visible in NIABrowser's Performance panel</p>
    <div class="btn-row">
      <button class="btn btn-blue" onclick="heavyDOM()">Heavy DOM (1000 divs)</button>
      <button class="btn btn-orange" onclick="heavyCompute()">Heavy Compute</button>
      <button class="btn btn-green" onclick="showPerf()">Show Metrics</button>
    </div>
    <div id="perf-metrics" style="margin-top:8px;"></div>
    <div id="perf-output" class="output">Ready...</div>
  </div>

  <div style="text-align:center;padding:20px;color:#8E8EA0;font-size:12px;">
    NIABrowser Test Page &mdash; <a href="../index.html">Home</a> &mdash; <a href="https://github.com/zizwar/niabrowser">GitHub</a>
  </div>

  <script>
    // Network Testing
    async function testFetch(method) {
      const out = document.getElementById('network-output');
      const url = method === 'GET' ? 'https://jsonplaceholder.typicode.com/posts/1' :
                  method === 'DELETE' ? 'https://jsonplaceholder.typicode.com/posts/1' :
                  'https://jsonplaceholder.typicode.com/posts';
      const opts = { method };
      if (method === 'POST' || method === 'PUT') {
        opts.headers = { 'Content-Type': 'application/json' };
        opts.body = JSON.stringify({ title: 'Test', body: 'NIABrowser test', userId: 1 });
      }
      appendOutput('network-output', `${method} ${url}...`, 'info');
      try {
        const start = performance.now();
        const res = await fetch(url, opts);
        const data = await res.json();
        const ms = (performance.now() - start).toFixed(0);
        appendOutput('network-output', `${res.status} OK (${ms}ms): ${JSON.stringify(data).slice(0, 120)}...`, 'success');
      } catch (e) {
        appendOutput('network-output', `Error: ${e.message}`, 'error');
      }
    }

    async function testMultiple() {
      appendOutput('network-output', 'Sending 5 parallel requests...', 'info');
      const urls = [
        'https://jsonplaceholder.typicode.com/posts/1',
        'https://jsonplaceholder.typicode.com/users/1',
        'https://jsonplaceholder.typicode.com/comments?postId=1',
        'https://jsonplaceholder.typicode.com/albums/1',
        'https://jsonplaceholder.typicode.com/todos/1',
      ];
      const start = performance.now();
      const results = await Promise.allSettled(urls.map(u => fetch(u).then(r => r.json())));
      const ms = (performance.now() - start).toFixed(0);
      appendOutput('network-output', `All 5 completed in ${ms}ms`, 'success');
    }

    // Console Error
    function triggerError() { undefined_function(); }

    // Storage
    function setStorage() {
      const items = { nia_test: 'hello', nia_count: '42', nia_config: JSON.stringify({theme:'dark',lang:'en'}), nia_timestamp: Date.now().toString() };
      Object.entries(items).forEach(([k,v]) => localStorage.setItem(k, v));
      appendOutput('storage-output', `Set ${Object.keys(items).length} localStorage items`, 'success');
    }
    function getStorage() {
      const items = [];
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        items.push(`${key} = ${localStorage.getItem(key)}`);
      }
      appendOutput('storage-output', items.length ? items.join('\n') : 'localStorage is empty', 'info');
    }
    function setCookie() {
      document.cookie = 'nia_test=hello;max-age=3600;path=/';
      document.cookie = 'nia_session=abc123;max-age=3600;path=/';
      document.cookie = 'nia_pref=dark;max-age=3600;path=/';
      appendOutput('storage-output', 'Set 3 test cookies', 'success');
    }
    function readCookies() {
      appendOutput('storage-output', document.cookie || '(no cookies)', 'info');
    }
    function clearCookies() {
      document.cookie.split(';').forEach(c => {
        document.cookie = c.trim().split('=')[0] + '=;max-age=0;path=/';
      });
      appendOutput('storage-output', 'Cleared all cookies', 'success');
    }

    // DOM
    function changeCounter(delta) {
      const el = document.getElementById('counter-display');
      el.textContent = parseInt(el.textContent) + delta;
    }
    function setColor(c) {
      const box = document.getElementById('color-box');
      box.style.background = c;
      box.textContent = c;
    }

    // Performance
    function heavyDOM() {
      const start = performance.now();
      const container = document.createElement('div');
      for (let i = 0; i < 1000; i++) {
        const div = document.createElement('div');
        div.textContent = `Item ${i}`;
        div.style.cssText = 'padding:2px;font-size:10px;color:#8E8EA0;';
        container.appendChild(div);
      }
      document.body.appendChild(container);
      setTimeout(() => container.remove(), 1000);
      appendOutput('perf-output', `Created 1000 DOM elements in ${(performance.now()-start).toFixed(1)}ms`, 'success');
    }
    function heavyCompute() {
      const start = performance.now();
      let sum = 0;
      for (let i = 0; i < 10000000; i++) sum += Math.sqrt(i);
      appendOutput('perf-output', `Computed 10M sqrt ops in ${(performance.now()-start).toFixed(1)}ms (sum=${sum.toFixed(0)})`, 'success');
    }
    function showPerf() {
      const perf = performance.getEntriesByType('navigation')[0];
      const el = document.getElementById('perf-metrics');
      el.innerHTML = `
        <span class="metric">DOM Load<span class="val">${perf ? (perf.domContentLoadedEventEnd - perf.startTime).toFixed(0) : '?'}ms</span></span>
        <span class="metric">Full Load<span class="val">${perf ? (perf.loadEventEnd - perf.startTime).toFixed(0) : '?'}ms</span></span>
        <span class="metric">DOM Nodes<span class="val">${document.getElementsByTagName('*').length}</span></span>
        <span class="metric">Scripts<span class="val">${document.scripts.length}</span></span>
      `;
    }

    // Helper
    function appendOutput(id, text, cls) {
      const el = document.getElementById(id);
      const line = document.createElement('div');
      line.className = cls || '';
      line.textContent = `[${new Date().toLocaleTimeString()}] ${text}`;
      el.appendChild(line);
      el.scrollTop = el.scrollHeight;
    }
  </script>
</body>
</html>
